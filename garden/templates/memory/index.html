{% extends "main.html" %}
{% load static %}

{% block my_title %}
Ø®Ø§Ø·Ø±Ù‡ Ù‡Ø§
{% endblock my_title %}

{% block main %}
    <link rel="stylesheet" href="{% static "css/memory/index.css" %}">
    
    <div class="memories-container">
        {% for i in memories %}
            <div class="memory-card">
                <img src="{{ media }}/{{ i.photo }}" alt="{{ i.title }}" class='img'>
                <h1>
                    <span>Ø¹Ù†ÙˆØ§Ù† Ø®Ø§Ø·Ø±Ù‡ : </span>
                    <span>{{ i.title }}</span>
                </h1>
                <hr>
                <p>
                    <span>Ù…ØªÙ† Ø®Ø§Ø·Ø±Ù‡ : </span>
                    <span>{{ i.text }}</span>
                </p>
                <hr>
                <p class='other-photo-title'>
                    <i class="fas fa-arrow-down custom-icon"></i>
                    Ø¹Ú©Ø³ Ù‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±
                    <i class="fas fa-arrow-down custom-icon"></i>
                </p>
                {% if i.memory_gallery.all %}
                    <div class="gallery">
                        {% for photo in i.memory_gallery.all %}
                                <img src="{{ media }}/{{ photo.photo }}" alt="{{ i.title }}" class='other-photo'>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class='error-message'>Ù‡ÛŒÚ† Ø¹Ú©Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</p>
                {% endif %}
                <hr class="hr-for-photo">
                <p>
                    <span>ØªØ§Ø±ÛŒØ® Ø®Ø§Ø·Ø±Ù‡ : </span>
                    <span>{{ i.memory_date }}</span>
                </p>
                <hr>
                <p>
                    <span>Ø«Ø¨Øª Ø´Ø¯Ù‡ ØªÙˆØ³Ø· : </span>
                    <span>{{ i.user }}</span>
                </p>
                
                <span class="heart" data-id="{{ i.id }}" onclick="toggleLike({{ i.id }})">
                    {% if i.id in list_memory_liked_id %}
                        â¤ï¸
                    {% else %}
                        ğŸ¤
                    {% endif %}
                </span>  

                {% comment %} Ø¨Ø±Ø§ÛŒ Ø§Ù¾Ø¯ÛŒØª Ú©Ø±Ø¯Ù† Ø®Ø§Ø·Ø±Ù‡  {% endcomment %}
                
                {% comment %} {% if user == i.user %}              
                <a href="{% url "memory:update" i.id %}" class='update'>ÙˆÛŒØ±Ø§ÛŒØ´</a>
                {% endif %} {% endcomment %}
            </div>
        {% endfor %}

    </div>

    <script>
      
        function toggleLike(id) {
            const heart = $('.heart[data-id="' + id + '"]');
            
            if (heart.html() === 'â¤ï¸') {
               
                removeLike(id);
            } else {
                
                like(id);
            }
        }

        function like(id) {
            $.ajax({
                type: 'GET',
                url: "{% url 'memory:like' %}",
                data: { memory: id },
                success: function() {
                   
                    $('.heart[data-id="' + id + '"]').html('â¤ï¸');
                }
            });
        }

        function removeLike(id) {
            $.ajax({
                type: 'GET',
                url: "{% url 'memory:removelike' %}",
                data: { memory: id },
                success: function() {
                  
                    $('.heart[data-id="' + id + '"]').html('ğŸ¤');
                }
            });
        }

    </script>

{% endblock main %}